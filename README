Scala port of AggregateSource project by Yves Reynhout
